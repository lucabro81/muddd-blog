---
import HomeLayout from '../../layouts/HomeLayout.astro';
import { getCollection } from 'astro:content';
import { i18n } from "astro:config/client";

export function getStaticPaths() {
  return i18n?.locales
  .filter((locale) => locale as string !== i18n?.defaultLocale)
  .map((locale) => ({ params: { locale: locale as string } }));
}

const { locale } = Astro.params;
const allPosts = (await getCollection('blog', ({ data }) => {
	return data.lang === locale;
})).sort((a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf());
---

<HomeLayout allPosts={allPosts} />

